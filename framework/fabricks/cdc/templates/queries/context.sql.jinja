/*
================================================================================
  FABRICKS CDC QUERY CONTEXT
================================================================================
{%- if cdc or mode %}

‚öôÔ∏è  CONFIGURATION
{%- if cdc %}
    CDC Type                : {{ cdc }}
{%- endif %}
{%- if mode %}
    Mode                    : {{ mode }}
{%- endif %}
{%- endif %}
{%- if format or src or tgt %}

--------------------------------------------------------------------------------
üéØ  SOURCE & TARGET
{%- if format %}
    Format                  : {{ format }}
{%- endif %}
{%- if src %}
    Source                  : {{ src | truncate(100, killwords=True) }}
{%- endif %}
{%- if tgt %}
    Target                  : {{ tgt }}
{%- endif %}
{%- endif %}
{%- if slice or deduplicate_key or deduplicate_hash or rectify or correct_valid_from or advanced_deduplication or order_duplicate_by %}

--------------------------------------------------------------------------------
üìä  DATA PROCESSING PIPELINE

    CTEs Enabled:
{%- if slice %}
        ‚úì Slice
{%- endif %}
{%- if deduplicate_key %}
        ‚úì Deduplicate Key
{%- endif %}
{%- if deduplicate_hash %}
        ‚úì Deduplicate Hash
{%- endif %}
{%- if rectify %}
        ‚úì Rectify
{%- endif %}
{%- if correct_valid_from %}
        ‚úì Correct Valid From
{%- endif %}
{%- if advanced_deduplication %}
        ‚úì Advanced Deduplication
{%- endif %}
{%- if order_duplicate_by %}
        ‚úì Order Duplicate By
{%- endif %}
{%- endif %}
{%- if filter_where or update_where or slices or sources %}

--------------------------------------------------------------------------------
üîç  FILTERING & CONDITIONS
{%- if filter_where %}
    Filter Where            : {{ filter_where }}
{%- endif %}
{%- if update_where %}
    Update Where            : {{ update_where }}
{%- endif %}
{%- if slices %}
    Slices                  : {{ slices }}
{%- endif %}
{%- if sources %}
    Sources                 : {{ sources }}
{%- endif %}
{%- endif %}
{%- if delete_missing or soft_delete %}

--------------------------------------------------------------------------------
üóëÔ∏è  DELETE OPTIONS
{%- if delete_missing %}
    Delete Missing          : ‚úì Enabled
{%- endif %}
{%- if soft_delete %}
    Soft Delete             : ‚úì Enabled
{%- endif %}
{%- endif %}
{%- if has_no_data is defined or has_rows is defined or has_source %}

--------------------------------------------------------------------------------
‚úÖ  DATA STATE
{%- if has_no_data is defined %}
{%- if has_no_data %}
    Has Data                : ‚úó No data
{%- else %}
    Has Data                : ‚úì Yes
{%- endif %}
{%- endif %}
{%- if has_rows is defined %}
{%- if has_rows %}
    Has Rows                : ‚úì Target has existing rows
{%- else %}
    Has Rows                : ‚úó Target is empty
{%- endif %}
{%- endif %}
{%- if has_source %}
    Source Tracking         : ‚úì Enabled
{%- endif %}
{%- endif %}
{%- if has_metadata or has_timestamp or has_last_updated or has_key or has_hash or has_operation or has_identity or has_rescued_data or has_order_by %}

--------------------------------------------------------------------------------
üè∑Ô∏è  SYSTEM COLUMNS (Existing)
{%- if has_metadata %}
    __metadata              : ‚úì
{%- endif %}
{%- if has_timestamp %}
    __timestamp             : ‚úì
{%- endif %}
{%- if has_last_updated %}
    __last_updated          : ‚úì
{%- endif %}
{%- if has_key %}
    __key                   : ‚úì
{%- endif %}
{%- if has_hash %}
    __hash                  : ‚úì
{%- endif %}
{%- if has_operation %}
    __operation             : ‚úì
{%- endif %}
{%- if has_identity %}
    __identity              : ‚úì
{%- endif %}
{%- if has_rescued_data %}
    __rescued_data          : ‚úì
{%- endif %}
{%- if has_order_by %}
    Order By                : ‚úì
{%- endif %}
{%- endif %}
{%- if add_metadata or add_timestamp or add_last_updated or add_key or add_hash or add_operation or add_source or add_calculated_columns %}

--------------------------------------------------------------------------------
‚ûï  SYSTEM COLUMNS (Adding)
{%- if add_metadata %}
    __metadata              : ‚úì
{%- endif %}
{%- if add_timestamp %}
    __timestamp             : ‚úì
{%- endif %}
{%- if add_last_updated %}
    __last_updated          : ‚úì
{%- endif %}
{%- if add_key %}
    __key                   : ‚úì
{%- endif %}
{%- if add_hash %}
    __hash                  : ‚úì
{%- endif %}
{%- if add_operation %}
    __operation             : {{ add_operation }}
{%- endif %}
{%- if add_source %}
    __source                : {{ add_source }}
{%- endif %}
{%- if add_calculated_columns %}
    Calculated Columns      : {{ add_calculated_columns }}
{%- endif %}
{%- endif %}
{%- if all_except or all_overwrite or overwrite or cast %}

--------------------------------------------------------------------------------
üîÑ  COLUMN TRANSFORMATIONS
{%- if all_except %}
    Exclude All Except      : {{ all_except | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if all_overwrite %}
    Overwrite All           : {{ all_overwrite | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if overwrite %}
    Overwrite               : {{ overwrite | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if cast %}
    Cast                    : {{ cast | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- endif %}
{%- if parent_slice or parent_deduplicate_key or parent_deduplicate_hash or parent_rectify or parent_cdc or parent_final %}

--------------------------------------------------------------------------------
üîó  CTE DEPENDENCIES
{%- if parent_slice %}
    parent_slice            : {{ parent_slice }}
{%- endif %}
{%- if parent_deduplicate_key %}
    parent_deduplicate_key  : {{ parent_deduplicate_key }}
{%- endif %}
{%- if parent_deduplicate_hash %}
    parent_deduplicate_hash : {{ parent_deduplicate_hash }}
{%- endif %}
{%- if parent_rectify %}
    parent_rectify          : {{ parent_rectify }}
{%- endif %}
{%- if parent_cdc %}
    parent_cdc              : {{ parent_cdc }}
{%- endif %}
{%- if parent_final %}
    parent_final            : {{ parent_final }}
{%- endif %}
{%- endif %}
{%- if keys or hashes or inputs or intermediates or outputs or columns %}

--------------------------------------------------------------------------------
üì¶  COLUMN LAYOUT
{%- if keys %}
    Keys                    : {{ keys | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if hashes %}
    Hashes                  : {{ hashes | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if inputs %}
    Inputs                  : {{ inputs | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if intermediates %}
    Intermediates           : {{ intermediates | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if outputs %}
    Outputs                 : {{ outputs | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if columns %}
    All Columns             : {{ columns | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- endif %}

================================================================================
*/

