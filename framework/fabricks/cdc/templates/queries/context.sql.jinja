/*
{%- if cdc or mode %}
âš™ï¸ Base Configuration
{%- if cdc %}
  â–¸ CDC Type: {{ cdc }}
{%- endif %}
{%- if mode %}
  â–¸ Mode: {{ mode }}
{%- endif %}
{%- endif %}
{%- if format or src or tgt %}
ğŸ¯ Source & Target
{%- if format %}
  â–¸ Format: {{ format }}
{%- endif %}
{%- if src %}
  â–¸ Source: {{ src | truncate(100, killwords=True) }}
{%- endif %}
{%- if tgt %}
  â–¸ Target: {{ tgt }}
{%- endif %}
{%- endif %}
{%- if slice or deduplicate_key or deduplicate_hash or rectify or correct_valid_from or advanced_deduplication or order_duplicate_by %}
ğŸ”„ Applied Transformations
{%- if slice %}
  â–¸ Slice
{%- endif %}
{%- if deduplicate_key %}
  â–¸ Deduplicate Key
{%- endif %}
{%- if deduplicate_hash %}
  â–¸ Deduplicate Hash
{%- endif %}
{%- if rectify %}
  â–¸ Rectify
{%- endif %}
{%- if correct_valid_from %}
  â–¸ Correct Valid From
{%- endif %}
{%- if advanced_deduplication %}
  â–¸ Advanced Deduplication
{%- endif %}
{%- if order_duplicate_by %}
  â–¸ Order Duplicate By
{%- endif %}
{%- endif %}
{%- if filter_where or update_where or slices or sources %}
ğŸ” Filtering & Slicing
{%- if filter_where %}
  â–¸ Filter Where: {{ filter_where }}
{%- endif %}
{%- if update_where %}
  â–¸ Update Where: {{ update_where }}
{%- endif %}
{%- if slices %}
  â–¸ Slices: {{ slices }}
{%- endif %}
{%- if sources %}
  â–¸ Sources: {{ sources }}
{%- endif %}
{%- endif %}
{%- if delete_missing or soft_delete %}
ğŸ—‘ï¸ Deletes
{%- if delete_missing %}
  â–¸ Delete Missing âœ“
{%- endif %}
{%- if soft_delete %}
  â–¸ Soft Delete âœ“
{%- endif %}
{%- endif %}
{%- if has_no_data is defined or has_rows is defined or has_source %}
âœ… Current State
{%- if has_no_data is defined %}
  â–¸ Data: {% if has_no_data %}âœ—{% else %}âœ“{% endif %}
{%- endif %}
{%- if has_rows is defined %}
  â–¸ Rows: {% if has_rows %}âœ“{% else %}âœ—{% endif %}
{%- endif %}
{%- if has_source %}
  â–¸ Source: âœ“
{%- endif %}
{%- endif %}
{%- if has_metadata or has_timestamp or has_last_updated or has_key or has_hash or has_operation or has_identity or has_rescued_data or has_order_by %}
ğŸ·ï¸ Found System Fields
{%- if has_metadata %}
  â–¸ __metadata
{%- endif %}
{%- if has_timestamp %}
  â–¸ __timestamp
{%- endif %}
{%- if has_last_updated %}
  â–¸ __last_updated
{%- endif %}
{%- if has_key %}
  â–¸ __key
{%- endif %}
{%- if has_hash %}
  â–¸ __hash
{%- endif %}
{%- if has_operation %}
  â–¸ __operation
{%- endif %}
{%- if has_identity %}
  â–¸ __identity
{%- endif %}
{%- if has_rescued_data %}
  â–¸ __rescued_data
{%- endif %}
{%- if has_order_by %}
  â–¸ Order By
{%- endif %}
{%- endif %}
{%- if add_metadata or add_timestamp or add_last_updated or add_key or add_hash or add_operation or add_source or add_calculated_columns %}
â• Added System Fields
{%- if add_metadata %}
  â–¸ __metadata
{%- endif %}
{%- if add_timestamp %}
  â–¸ __timestamp
{%- endif %}
{%- if add_last_updated %}
  â–¸ __last_updated
{%- endif %}
{%- if add_key %}
  â–¸ __key
{%- endif %}
{%- if add_hash %}
  â–¸ __hash
{%- endif %}
{%- if add_operation %}
  â–¸ __operation = {{ add_operation }}
{%- endif %}
{%- if add_source %}
  â–¸ __source = {{ add_source }}
{%- endif %}
{%- if add_calculated_columns %}
  â–¸ Calculated = {{ add_calculated_columns }}
{%- endif %}
{%- endif %}
{%- if all_except or all_overwrite or overwrite or cast %}
ğŸ”§ Column Transformations
{%- if all_except %}
  â–¸ Exclude All Except: {{ all_except | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if all_overwrite %}
  â–¸ Overwrite All: {{ all_overwrite | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if overwrite %}
  â–¸ Overwrite: {{ overwrite | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if cast %}
  â–¸ Cast: {{ cast | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- endif %}
{%- if parent_slice or parent_deduplicate_key or parent_deduplicate_hash or parent_rectify or parent_cdc or parent_final %}
ğŸ”— CTE Lineage
{%- if parent_slice %}
  â–¸ parent_slice â†’ {{ parent_slice }}
{%- endif %}
{%- if parent_deduplicate_key %}
  â–¸ parent_deduplicate_key â†’ {{ parent_deduplicate_key }}
{%- endif %}
{%- if parent_deduplicate_hash %}
  â–¸ parent_deduplicate_hash â†’ {{ parent_deduplicate_hash }}
{%- endif %}
{%- if parent_rectify %}
  â–¸ parent_rectify â†’ {{ parent_rectify }}
{%- endif %}
{%- if parent_cdc %}
  â–¸ parent_cdc â†’ {{ parent_cdc }}
{%- endif %}
{%- if parent_final %}
  â–¸ parent_final â†’ {{ parent_final }}
{%- endif %}
{%- endif %}
{%- if keys or hashes or inputs or intermediates or outputs or columns %}
ğŸ“¦ Columns
{%- if keys %}
  â–¸ Keys: {{ keys | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if hashes %}
  â–¸ Hashes: {{ hashes | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if inputs %}
  â–¸ Inputs: {{ inputs | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if intermediates %}
  â–¸ Intermediates: {{ intermediates | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if outputs %}
  â–¸ Outputs: {{ outputs | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- if columns %}
  â–¸ All Columns: {{ columns | join(", ") | truncate(100, killwords=True) }}
{%- endif %}
{%- endif %}
*/
